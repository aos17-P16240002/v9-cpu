## Dune 阅读笔记

[原文链接](https://www.usenix.org/system/files/conference/osdi12/osdi12-final-117.pdf)

Dune可以提供给应用对于CPU特权指令的直接访问，同时还能够保持安全的访问控制。

目前大多数的操作系统都使用系统调用提供应用对于CPU特权指令的访问，但是在一些对性能有着苛刻要求的应用中，系统调用的效率太低。
应用希望能够直接执行某些CPU特权指令。对于这种需求，可以通过开发领域专用操作系统来实现，但这一工作量太大。

对着CPU硬件技术的发展，已经可以在硬件层面支持虚拟化技术，比如Intel的VT-x扩展，不同于之前的区分不同的ring，VT-x提供root和非root两种工作模式，都可以执行CPU特权指令。

结合这一CPU硬件虚拟化技术，这篇文章中提供了一种能够为应用提供CPU特权指令直接执行的新的方法。

通过使用CPU硬件虚拟化技术，在64Bit Linux上实现一个进程，称为Dune。Dune提供一个可载入的内核模块，通过这一模块，就进入了Dune模式，也就是CPU的非root模式，在这个模式下应用程序就可以直接执行CPU特权指令。
并且，作者还提供了一个用户级别的库libDune，方面基于Dune开发不同的应用程序。


随着硬件层面上对虚拟化技术的进一步支持，传统的一些虚拟化的软件架构需要进行必要的改变、重整才能充分地利用硬件资源，以达到更好的性能。

### 为什么需要新的像Dune这样的架构或者OS？ 

在操作系统中对于不同的硬件进行不同的抽象，由于抽象层次以及访问权限的控制，在这不同的抽象之上，可以实现适用不同应用场景的应用。

### 通过Dune使用特权CPU的示例 

* 提高垃圾回收器的工作效率
垃圾回收器通过Dune可以直接访问页表标记为，绕过系统调用，减少时间的消耗

* 提高sandbox的性能 


### Dune的优势
Dune能够直接使用特权CPU资源，又能够使用Host OS提供的服务。
实现这些特性都需要虚拟化技术的支持，包括CPU硬件虚拟化技术。
文中的工作基本上都是尽可能地利用CPU虚拟化技术，来实现这些功能。
